var I=Object.defineProperty;var R=t=>{throw TypeError(t)};var x=(t,e,s)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var S=(t,e,s)=>x(t,typeof e!="symbol"?e+"":e,s),w=(t,e,s)=>e.has(t)||R("Cannot "+s);var a=(t,e,s)=>(w(t,e,"read from private field"),s?s.call(t):e.get(t)),d=(t,e,s)=>e.has(t)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),D=(t,e,s,i)=>(w(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s);import{F,a9 as C,ae as A,aa as O,K as M,$ as k,H as E,W as U,aC as B,a1 as Y,M as $,Q as G,aD as K,R as L,aE as P,T as Q,U as V,N as W,V as y,aF as H,a6 as j,aG as q,am as z,g as J,ai as X,aH as Z,e as ee}from"./BepynHdk.js";var h,l,u,b,p,v,m;class se{constructor(e,s=!0){S(this,"anchor");d(this,h,new Map);d(this,l,new Map);d(this,u,new Map);d(this,b,new Set);d(this,p,!0);d(this,v,()=>{var e=F;if(a(this,h).has(e)){var s=a(this,h).get(e),i=a(this,l).get(s);if(i)C(i),a(this,b).delete(s);else{var f=a(this,u).get(s);f&&(a(this,l).set(s,f.effect),a(this,u).delete(s),f.fragment.lastChild.remove(),this.anchor.before(f.fragment),i=f.effect)}for(const[r,n]of a(this,h)){if(a(this,h).delete(r),r===e)break;const c=a(this,u).get(n);c&&(A(c.effect),a(this,u).delete(n))}for(const[r,n]of a(this,l)){if(r===s||a(this,b).has(r))continue;const c=()=>{if(Array.from(a(this,h).values()).includes(r)){var _=document.createDocumentFragment();B(n,_),_.append(M()),a(this,u).set(r,{effect:n,fragment:_})}else A(n);a(this,b).delete(r),a(this,l).delete(r)};a(this,p)||!i?(a(this,b).add(r),O(n,c,!1)):c()}}});d(this,m,e=>{a(this,h).delete(e);const s=Array.from(a(this,h).values());for(const[i,f]of a(this,u))s.includes(i)||(A(f.effect),a(this,u).delete(i))});this.anchor=e,D(this,p,s)}ensure(e,s){var i=F,f=Y();if(s&&!a(this,l).has(e)&&!a(this,u).has(e))if(f){var r=document.createDocumentFragment(),n=M();r.append(n),a(this,u).set(e,{effect:k(()=>s(n)),fragment:r})}else a(this,l).set(e,k(()=>s(this.anchor)));if(a(this,h).set(i,e),f){for(const[c,o]of a(this,l))c===e?i.unskip_effect(o):i.skip_effect(o);for(const[c,o]of a(this,u))c===e?i.unskip_effect(o.effect):i.skip_effect(o.effect);i.oncommit(a(this,v)),i.ondiscard(a(this,m))}else E&&(this.anchor=U),a(this,v).call(this)}}h=new WeakMap,l=new WeakMap,u=new WeakMap,b=new WeakMap,p=new WeakMap,v=new WeakMap,m=new WeakMap;function ie(t,e,s=!1){E&&G();var i=new se(t),f=s?K:0;function r(n,c){if(E){const T=L(t);var o;if(T===P?o=0:T===Q?o=!1:o=parseInt(T.substring(1)),n!==o){var _=V();W(_),i.anchor=_,y(!1),i.ensure(n,c),y(!0);return}}i.ensure(n,c)}$(()=>{var n=!1;e((c,o=0)=>{n=!0,r(o,c)}),n||r(!1,null)},f)}let g=!1,N=Symbol();function re(t,e,s){const i=s[e]??(s[e]={store:null,source:j(void 0),unsubscribe:H});if(i.store!==t&&!(N in s))if(i.unsubscribe(),i.store=t??null,t==null)i.source.v=void 0,i.unsubscribe=H;else{var f=!0;i.unsubscribe=q(t,r=>{f?i.source.v=r:ee(i.source,r)}),f=!1}return t&&N in s?z(t):J(i.source)}function ne(){const t={};function e(){X(()=>{for(var s in t)t[s].unsubscribe();Z(t,N,{enumerable:!1,value:!0})})}return[t,e]}function fe(t){var e=g;try{return g=!1,[t(),g]}finally{g=e}}export{se as B,re as a,fe as c,ie as i,ne as s};
