import{al as l,J as a}from"./BepynHdk.js";const b=a(null),m=a([]),T=a([]),x=a(null),E=a([]),P=a(!1),C=a(null),k=a(!1),w=a([]);let j=0;function S(t,e="info"){const n=++j;w.update(s=>[...s,{id:n,message:t,type:e}]),setTimeout(()=>{w.update(s=>s.filter(i=>i.id!==n))},4e3)}const O=l(b,t=>{if(!t)return 0;let e=t.cabinets.length;return t.cabinet&&(e+=1),e}),$=l(m,t=>t.length);l(x,t=>t!==null&&t.errors.length>0);const f="/api";let u=null;async function r(){if(u)return u;const t=await fetch(`${f}/sessions`,{method:"POST"});if(!t.ok)throw new Error("Failed to create session");return u=(await t.json()).id,u}function c(t){return`${f}/sessions/${u}${t}`}async function d(t){await r();const e=await fetch(c(t));if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Error(n.error||e.statusText)}return e.json()}async function o(t,e){await r();const n=await fetch(c(t),{method:"POST",headers:e!==void 0?{"Content-Type":"application/json"}:{},body:e!==void 0?JSON.stringify(e):void 0});if(!n.ok){const i=await n.json().catch(()=>({error:n.statusText}));throw new Error(i.error||n.statusText)}const s=await n.text();return s?JSON.parse(s):void 0}async function p(t,e){await r();const n=await fetch(c(t),{method:"PUT",headers:e!==void 0?{"Content-Type":"application/json"}:{},body:e!==void 0?JSON.stringify(e):void 0});if(!n.ok){const i=await n.json().catch(()=>({error:n.statusText}));throw new Error(i.error||n.statusText)}const s=await n.text();return s?JSON.parse(s):void 0}async function v(t){await r();const e=await fetch(c(t),{method:"DELETE"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Error(n.error||e.statusText)}return e.json()}async function h(t){await r();const e=await fetch(c(t));if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Error(n.error||e.statusText)}return e.text()}async function R(){return o("/project/new")}async function L(t){return p("/project",t)}async function U(t,e){return o("/project/open",{toml_content:t,filename:e})}async function F(){await r();const t=await fetch(c("/project/save"),{method:"POST"});if(!t.ok){const e=await t.json().catch(()=>({error:t.statusText}));throw new Error(e.error||t.statusText)}return t.text()}async function J(t){return o(`/project/template/${t}`)}async function B(){const t=await fetch(`${f}/templates`);if(!t.ok)throw new Error("Failed to list templates");return t.json()}async function N(){return o("/parts")}async function A(t){return o("/cabinets",t)}async function D(t,e){return p(`/cabinets/${t}`,e)}async function G(t){return v(`/cabinets/${t}`)}async function _(t){return o("/cabinets/preview",t)}async function I(t){return d(`/cabinets/${t}/3d`)}async function q(t){return o("/nesting",{config:null})}async function z(t,e,n){return h(`/nesting/${t}/${e}/svg`)}async function M(){return o("/gcode/validate")}async function V(){return o("/gcode/generate",null)}async function H(t,e){return h(`/gcode/${t}/${e}`)}async function K(){return d("/export/cutlist")}async function Q(){await r();const t=await fetch(c("/export/csv"));if(!t.ok)throw new Error("Failed to export CSV");const e=await t.blob();y(e,"cutlist.csv")}async function W(){await r();const t=await fetch(c("/export/bom"));if(!t.ok)throw new Error("Failed to export BOM");const e=await t.blob();y(e,"bom.json")}function y(t,e){const n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}export{I as A,O as B,$ as C,U as D,F as E,w as F,C as a,P as b,J as c,_ as d,A as e,m as f,N as g,K as h,k as i,E as j,x as k,B as l,Q as m,R as n,W as o,b as p,V as q,G as r,S as s,H as t,D as u,M as v,L as w,z as x,T as y,q as z};
