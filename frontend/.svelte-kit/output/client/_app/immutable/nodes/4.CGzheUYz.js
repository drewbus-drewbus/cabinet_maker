import{d as Nt,c as Ot,a as n,b as G,f as c,s as d,t as St}from"../chunks/CyNfHtry.js";import{p as Vt,u as At,f as D,a as Bt,c as e,s,r as t,g as a,h as Ft,b as tt,t as f,n as Gt,e as H}from"../chunks/DUOIInB9.js";import{i as j,a as I,s as qt}from"../chunks/B22MubrG.js";import{e as q,i as L}from"../chunks/C2eLq_D0.js";import{i as et,h as Lt,j as rt,s as E,v as Pt,k as at,p as Mt,m as Tt,o as Ut}from"../chunks/B-0l54sc.js";var Wt=c('<div class="text-xs text-red-300"> </div>'),zt=c('<div class="mb-4 p-3 bg-red-900/30 border border-red-600/50 rounded"><h3 class="text-sm font-semibold text-error mb-1"> </h3> <!></div>'),Dt=c('<div class="text-xs text-yellow-300"> </div>'),Ht=c('<div class="mb-4 p-3 bg-yellow-900/30 border border-yellow-600/50 rounded"><h3 class="text-sm font-semibold text-warning mb-1"> </h3> <!></div>'),It=c("<!> <!>",1),Kt=c('<th class="py-2 px-2 text-left cursor-pointer hover:text-text-primary"> <!></th>'),Qt=c('<tr class="border-b border-border/30 hover:bg-surface/50"><td class="py-1 px-2"> </td><td class="py-1 px-2 font-medium"> </td><td class="py-1 px-2"> </td><td class="py-1 px-2 text-right font-mono"> </td><td class="py-1 px-2 text-right font-mono"> </td><td class="py-1 px-2 text-right font-mono"> </td><td class="py-1 px-2 text-center"> </td><td class="py-1 px-2 text-xs text-text-secondary"> </td></tr>'),Xt=c('<div class="overflow-auto"><table class="w-full text-sm"><thead><tr class="text-text-secondary border-b border-border"><!><th class="py-2 px-2 text-left">Operations</th></tr></thead><tbody></tbody></table></div> <div class="mt-3 text-xs text-text-secondary"> </div>',1),Yt=c('<p class="text-text-secondary">No parts generated yet. Go to Cabinets and click "Generate All Parts".</p>'),Zt=c('<div><div class="flex items-center justify-between mb-4"><h1 class="text-2xl font-bold">Cut List</h1> <div class="flex gap-2"><button class="px-3 py-1 text-xs bg-surface hover:bg-surface-hover rounded">Refresh</button> <button class="px-3 py-1 text-xs bg-surface hover:bg-surface-hover rounded">Export CSV</button> <button class="px-3 py-1 text-xs bg-surface hover:bg-surface-hover rounded">Export JSON</button></div></div> <!> <!></div>'),te=c('<div class="text-text-secondary"><p>No project loaded. <a href="/" class="text-accent hover:underline">Go home</a> to create or open one.</p></div>');function de(st,ot){Vt(ot,!0);const A=()=>I(Mt,"$project",P),dt=()=>I(rt,"$cutlistRows",P),h=()=>I(at,"$validationResult",P),[P,it]=qt();let R=tt("cabinet"),J=tt(!0);async function K(){if(A())try{et.set(!0);const r=await Lt();rt.set(r)}catch(r){E(`Error: ${r}`,"error")}finally{et.set(!1)}}async function nt(){if(A())try{const r=await Pt();at.set(r)}catch(r){E(`Validation error: ${r}`,"error")}}async function vt(){try{await Tt(),E("CSV downloaded","success")}catch(r){E(`Error: ${r}`,"error")}}async function ct(){try{await Ut(),E("BOM JSON downloaded","success")}catch(r){E(`Error: ${r}`,"error")}}function lt(r){a(R)===r?H(J,!a(J)):(H(R,r,!0),H(J,!0))}const M=Ft(()=>[...dt()].sort((r,b)=>{const m=r[a(R)],N=b[a(R)],O=typeof m=="string"?m.localeCompare(N):m-N;return a(J)?O:-O}));At(()=>{A()&&(K(),nt())});var Q=Ot(),xt=D(Q);{var pt=r=>{var b=Zt(),m=e(b),N=s(e(m),2),O=e(N),X=s(O,2),_t=s(X,2);t(N),t(m);var Y=s(m,2);{var ft=l=>{var g=It(),C=D(g);{var B=u=>{var x=zt(),p=e(x),V=e(p);t(p);var y=s(p,2);q(y,1,()=>h().errors,L,(o,v)=>{var i=Wt(),w=e(i,!0);t(i),f(_=>d(w,_),[()=>JSON.stringify(a(v))]),n(o,i)}),t(x),f(()=>d(V,`Errors (${h().errors.length??""})`)),n(u,x)};j(C,u=>{h().errors.length>0&&u(B)})}var S=s(C,2);{var F=u=>{var x=Ht(),p=e(x),V=e(p);t(p);var y=s(p,2);q(y,1,()=>h().warnings,L,(o,v)=>{var i=Dt(),w=e(i,!0);t(i),f(_=>d(w,_),[()=>JSON.stringify(a(v))]),n(o,i)}),t(x),f(()=>d(V,`Warnings (${h().warnings.length??""})`)),n(u,x)};j(S,u=>{h().warnings.length>0&&u(F)})}n(l,g)};j(Y,l=>{h()&&l(ft)})}var ht=s(Y,2);{var bt=l=>{var g=Xt(),C=D(g),B=e(C),S=e(B),F=e(S),u=e(F);q(u,16,()=>["cabinet","label","material","width","height","thickness","quantity"],L,(y,o)=>{var v=Kt(),i=e(v),w=s(i);{var _=$=>{var k=St();f(()=>d(k,a(J)?" ^":" v")),n($,k)};j(w,$=>{a(R)===o&&$(_)})}t(v),f($=>d(i,`${$??""} `),[()=>o.charAt(0).toUpperCase()+o.slice(1)]),G("click",v,()=>lt(o)),n(y,v)}),Gt(),t(F),t(S);var x=s(S);q(x,21,()=>a(M),L,(y,o)=>{var v=Qt(),i=e(v),w=e(i,!0);t(i);var _=s(i),$=e(_,!0);t(_);var k=s(_),gt=e(k,!0);t(k);var T=s(k),yt=e(T);t(T);var U=s(T),wt=e(U);t(U);var W=s(U),$t=e(W);t(W);var z=s(W),Ct=e(z,!0);t(z);var Z=s(z),kt=e(Z,!0);t(Z),t(v),f((jt,Et,Rt,Jt)=>{d(w,a(o).cabinet),d($,a(o).label),d(gt,a(o).material),d(yt,`${jt??""}"`),d(wt,`${Et??""}"`),d($t,`${Rt??""}"`),d(Ct,a(o).quantity),d(kt,Jt)},[()=>a(o).width.toFixed(3),()=>a(o).height.toFixed(3),()=>a(o).thickness.toFixed(3),()=>a(o).operations.join(", ")||"-"]),n(y,v)}),t(x),t(B),t(C);var p=s(C,2),V=e(p);t(p),f(()=>d(V,`${a(M).length??""} parts total`)),n(l,g)},mt=l=>{var g=Yt();n(l,g)};j(ht,l=>{a(M).length>0?l(bt):l(mt,!1)})}t(b),G("click",O,K),G("click",X,vt),G("click",_t,ct),n(r,b)},ut=r=>{var b=te();n(r,b)};j(xt,r=>{A()?r(pt):r(ut,!1)})}n(st,Q),Bt(),it()}Nt(["click"]);export{de as component};
