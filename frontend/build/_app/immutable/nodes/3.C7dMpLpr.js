import{d as it,c as dt,a as g,s as T,b,f as $,e as w}from"../chunks/pWOMhstZ.js";import{p as bt,b as ut,d as vt,u as pt,f as Ce,a as xt,e as _t,c as r,s,r as e,t as W,g as t,h as ee,n as $e}from"../chunks/BepynHdk.js";import{i as K,a as Fe,s as ht}from"../chunks/CaLNNbA5.js";import{e as pe,i as xe}from"../chunks/9pRRSWtK.js";import{r as y,s as C,a as Pe}from"../chunks/BfDX1O-d.js";import{s as ft}from"../chunks/DkQQvypr.js";import{i as mt,s as yt}from"../chunks/FQInl4Sy.js";import{d as gt,s as A,p as te,i as q,r as kt,b as ae,e as wt,g as Ct,f as $t,u as Ft}from"../chunks/DEoDEiov.js";import{s as Q}from"../chunks/Gq__uSar.js";import{p as _e}from"../chunks/DiomP2yI.js";var Pt=$('<div role="button" tabindex="0"><div><div class="font-medium"> </div> <div class="text-xs text-text-secondary"> </div></div> <button class="text-text-secondary hover:text-error text-xs px-1">x</button></div>'),St=$('<button class="mt-4 w-full px-3 py-2 text-xs bg-surface hover:bg-surface-hover rounded text-center">Generate All Parts</button>'),jt=$("<option> </option>"),Et=$('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Toe Kick</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Height</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Setback</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div></div></div>'),Tt=$('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Drawers</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Count</label> <input type="number" min="1" max="10" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Slide Clearance</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div></div></div>'),Bt=$('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Stretchers</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Front Width</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="flex items-center gap-2 text-xs text-text-secondary cursor-pointer mt-5"><input type="checkbox" class="accent-accent"/> Has Rear Stretcher</label></div></div></div>'),Dt=$('<tr class="border-b border-border/50"><td class="py-1"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td></tr>'),Ht=$('<div class="mt-6 border-t border-border pt-4"><h3 class="text-sm font-semibold mb-2"> </h3> <div class="overflow-auto max-h-64"><table class="w-full text-xs"><thead><tr class="text-text-secondary border-b border-border"><th class="py-1 text-left">Label</th><th class="py-1 text-right">Width</th><th class="py-1 text-right">Height</th><th class="py-1 text-right">Qty</th><th class="py-1 text-right">Ops</th></tr></thead><tbody></tbody></table></div></div>'),It=$('<h2 class="text-lg font-semibold mb-4"> </h2> <div class="grid grid-cols-2 gap-4 max-w-lg"><div class="col-span-2"><label class="block text-xs text-text-secondary mb-1">Name</label> <input type="text" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div class="col-span-2"><label class="block text-xs text-text-secondary mb-1">Type</label> <select class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"></select></div> <div><label class="block text-xs text-text-secondary mb-1">Width</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Height</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Depth</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Shelves</label> <input type="number" min="0" max="20" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Material Thickness</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Back Thickness</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="flex items-center gap-2 text-xs text-text-secondary cursor-pointer"><input type="checkbox" class="accent-accent"/> Has Back Panel</label></div> <!> <!> <!></div> <!>',1),Gt=$('<div class="flex items-center justify-center h-full text-text-secondary"><p>Select a cabinet from the list or add a new one</p></div>'),Wt=$('<div class="flex gap-6 h-full"><div class="w-56 flex-shrink-0"><div class="flex items-center justify-between mb-3"><h2 class="text-lg font-semibold">Cabinets</h2> <button class="px-2 py-1 text-xs bg-accent hover:bg-accent/80 text-white rounded">+ Add</button></div> <div class="space-y-1"></div> <!></div> <div class="flex-1 overflow-auto"><!></div></div>'),At=$('<div class="text-text-secondary"><p>No project loaded. <a href="/" class="text-accent hover:underline">Go home</a> to create or open one.</p></div>');function Jt(Se,je){bt(je,!0);const B=()=>Fe(Q,"$selectedCabinetIndex",he),L=()=>Fe(te,"$project",he),[he,Ee]=ht();let U=ut(vt([]));const Te=[{value:"basic_box",label:"Basic Box"},{value:"base_cabinet",label:"Base Cabinet"},{value:"wall_cabinet",label:"Wall Cabinet"},{value:"tall_cabinet",label:"Tall Cabinet"},{value:"sink_base",label:"Sink Base"},{value:"drawer_bank",label:"Drawer Bank"}];function Be(){return{name:"New Cabinet",cabinet_type:"basic_box",width:36,height:30,depth:12,material_thickness:.75,back_thickness:.25,shelf_count:2,shelf_joinery:"dado",dado_depth_fraction:.5,has_back:!0,back_joinery:"rabbet",toe_kick:null,drawers:null,stretchers:null,construction:"frameless",face_frame:null,material_ref:null,back_material_ref:null}}async function De(){_e();try{q.set(!0);const a=Be(),n=await wt(a);te.update(p=>(p&&p.cabinets.push(a),p)),Q.set(n),ae.set(!0),A("Cabinet added","success")}catch(a){A(`Error: ${a}`,"error")}finally{q.set(!1)}}async function He(a){_e();try{q.set(!0),await kt(a),te.update(n=>(n&&n.cabinets.splice(a,1),n)),B()===a&&Q.set(null),ae.set(!0),A("Cabinet removed","success")}catch(n){A(`Error: ${n}`,"error")}finally{q.set(!1)}}async function _(){_e();const a=B(),n=L();if(!(a===null||!n||a>=n.cabinets.length))try{await Ft(a,n.cabinets[a]),ae.set(!0)}catch(p){A(`Error: ${p}`,"error")}}async function Ie(){try{q.set(!0);const a=await Ct();$t.set(a),A(`Generated ${a.length} parts`,"success")}catch(a){A(`Error: ${a}`,"error")}finally{q.set(!1)}}async function Ge(){const a=B(),n=L();if(!(a===null||!n||a>=n.cabinets.length))try{_t(U,await gt(n.cabinets[a]),!0)}catch(p){A(`Error: ${p}`,"error")}}function h(a,n){const p=B();te.update(H=>(H&&p!==null&&p<H.cabinets.length&&(H.cabinets[p][a]=n),H)),ae.set(!0)}function We(){const a=B(),n=L();return a===null||!n||a>=n.cabinets.length?null:n.cabinets[a]}pt(()=>{B()!==null&&Ge()});const o=ee(We),Ae=ee(()=>{var a,n,p;return((a=t(o))==null?void 0:a.cabinet_type)==="base_cabinet"||((n=t(o))==null?void 0:n.cabinet_type)==="tall_cabinet"||((p=t(o))==null?void 0:p.cabinet_type)==="drawer_bank"}),Ne=ee(()=>{var a;return((a=t(o))==null?void 0:a.cabinet_type)==="drawer_bank"}),Ke=ee(()=>{var a;return((a=t(o))==null?void 0:a.cabinet_type)==="sink_base"});var fe=dt(),Le=Ce(fe);{var Re=a=>{var n=Wt(),p=r(n),H=r(p),Me=s(r(H),2);e(H);var re=s(H,2);pe(re,5,()=>L().cabinets,xe,(k,P,S)=>{var I=Pt();let R;var N=r(I),G=r(N),M=r(G,!0);e(G);var j=s(G,2),z=r(j,!0);e(j),e(N);var O=s(N,2);e(I),W(E=>{R=ft(I,1,"w-full flex items-center justify-between px-3 py-2 text-sm rounded transition-colors text-left cursor-pointer",null,R,{"bg-surface":B()===S,"text-accent":B()===S,"hover:bg-surface-hover":B()!==S}),T(M,t(P).name),T(z,E)},[()=>t(P).cabinet_type.replace("_"," ")]),b("click",I,()=>Q.set(S)),b("keydown",I,E=>{E.key==="Enter"&&Q.set(S)}),b("click",O,E=>{E.stopPropagation(),He(S)}),g(k,I)}),e(re);var Oe=s(re,2);{var Qe=k=>{var P=St();b("click",P,Ie),g(k,P)};K(Oe,k=>{L().cabinets.length>0&&k(Qe)})}e(p);var me=s(p,2),Ue=r(me);{var ze=k=>{var P=It(),S=Ce(P),I=r(S);e(S);var R=s(S,2),N=r(R),G=s(r(N),2);y(G),e(N);var M=s(N,2),j=s(r(M),2);pe(j,21,()=>Te,xe,(l,u)=>{var x=jt(),f=r(x,!0);e(x);var d={};W(()=>{T(f,t(u).label),d!==(d=t(u).value)&&(x.value=(x.__value=t(u).value)??"")}),g(l,x)}),e(j);var z;mt(j),e(M);var O=s(M,2),E=s(r(O),2);y(E),e(O);var se=s(O,2),J=s(r(se),2);y(J),e(se);var le=s(se,2),V=s(r(le),2);y(V),e(le);var oe=s(le,2),X=s(r(oe),2);y(X),e(oe);var ne=s(oe,2),Y=s(r(ne),2);y(Y),e(ne);var ce=s(ne,2),Z=s(r(ce),2);y(Z),e(ce);var ie=s(ce,2),ye=r(ie),de=r(ye);y(de),$e(),e(ye),e(ie);var ge=s(ie,2);{var Ve=l=>{var u=Et(),x=s(r(u),2),f=r(x),d=s(r(f),2);y(d),e(f);var F=s(f,2),m=s(r(F),2);y(m),e(F),e(x),e(u),W(()=>{var v,c;C(d,((v=t(o).toe_kick)==null?void 0:v.height)??4),C(m,((c=t(o).toe_kick)==null?void 0:c.setback)??3)}),b("input",d,v=>{var i;const c=((i=t(o))==null?void 0:i.toe_kick)??{height:4,setback:3};c.height=parseFloat(v.target.value),h("toe_kick",c)}),w("blur",d,_),b("input",m,v=>{var i;const c=((i=t(o))==null?void 0:i.toe_kick)??{height:4,setback:3};c.setback=parseFloat(v.target.value),h("toe_kick",c)}),w("blur",m,_),g(l,u)};K(ge,l=>{t(Ae)&&l(Ve)})}var ke=s(ge,2);{var Xe=l=>{var u=Tt(),x=s(r(u),2),f=r(x),d=s(r(f),2);y(d),e(f);var F=s(f,2),m=s(r(F),2);y(m),e(F),e(x),e(u),W(()=>{var v,c;C(d,((v=t(o).drawers)==null?void 0:v.count)??4),C(m,((c=t(o).drawers)==null?void 0:c.slide_clearance)??.5)}),b("input",d,v=>{var i;const c=((i=t(o))==null?void 0:i.drawers)??{count:4,opening_height:0,slide_clearance:.5};c.count=parseInt(v.target.value),h("drawers",c)}),w("blur",d,_),b("input",m,v=>{var i;const c=((i=t(o))==null?void 0:i.drawers)??{count:4,opening_height:0,slide_clearance:.5};c.slide_clearance=parseFloat(v.target.value),h("drawers",c)}),w("blur",m,_),g(l,u)};K(ke,l=>{t(Ne)&&l(Xe)})}var Ye=s(ke,2);{var Ze=l=>{var u=Bt(),x=s(r(u),2),f=r(x),d=s(r(f),2);y(d),e(f);var F=s(f,2),m=r(F),v=r(m);y(v),$e(),e(m),e(F),e(x),e(u),W(()=>{var c,i;C(d,((c=t(o).stretchers)==null?void 0:c.front_width)??4),Pe(v,((i=t(o).stretchers)==null?void 0:i.has_rear)??!0)}),b("input",d,c=>{var D;const i=((D=t(o))==null?void 0:D.stretchers)??{front_width:4,has_rear:!0};i.front_width=parseFloat(c.target.value),h("stretchers",i)}),w("blur",d,_),b("change",v,c=>{var D;const i=((D=t(o))==null?void 0:D.stretchers)??{front_width:4,has_rear:!0};i.has_rear=c.target.checked,h("stretchers",i),_()}),g(l,u)};K(Ye,l=>{t(Ke)&&l(Ze)})}e(R);var et=s(R,2);{var tt=l=>{var u=Ht(),x=r(u),f=r(x);e(x);var d=s(x,2),F=r(d),m=s(r(F));pe(m,21,()=>t(U),xe,(v,c)=>{var i=Dt(),D=r(i),at=r(D,!0);e(D);var be=s(D),rt=r(be);e(be);var ue=s(be),st=r(ue);e(ue);var ve=s(ue),lt=r(ve,!0);e(ve);var we=s(ve),ot=r(we,!0);e(we),e(i),W((nt,ct)=>{T(at,t(c).label),T(rt,`${nt??""}"`),T(st,`${ct??""}"`),T(lt,t(c).quantity),T(ot,t(c).operations.length)},[()=>t(c).rect.width.toFixed(3),()=>t(c).rect.height.toFixed(3)]),g(v,i)}),e(m),e(F),e(d),e(u),W(()=>T(f,`Parts Preview (${t(U).length??""} parts)`)),g(l,u)};K(et,l=>{t(U).length>0&&l(tt)})}W(()=>{T(I,`Edit: ${t(o).name??""}`),C(G,t(o).name),z!==(z=t(o).cabinet_type)&&(j.value=(j.__value=t(o).cabinet_type)??"",yt(j,t(o).cabinet_type)),C(E,t(o).width),C(J,t(o).height),C(V,t(o).depth),C(X,t(o).shelf_count),C(Y,t(o).material_thickness),C(Z,t(o).back_thickness),Pe(de,t(o).has_back)}),b("input",G,l=>h("name",l.target.value)),w("blur",G,_),b("change",j,l=>{h("cabinet_type",l.target.value),_()}),b("input",E,l=>h("width",parseFloat(l.target.value))),w("blur",E,_),b("input",J,l=>h("height",parseFloat(l.target.value))),w("blur",J,_),b("input",V,l=>h("depth",parseFloat(l.target.value))),w("blur",V,_),b("input",X,l=>h("shelf_count",parseInt(l.target.value))),w("blur",X,_),b("input",Y,l=>h("material_thickness",parseFloat(l.target.value))),w("blur",Y,_),b("input",Z,l=>h("back_thickness",parseFloat(l.target.value))),w("blur",Z,_),b("change",de,l=>{h("has_back",l.target.checked),_()}),g(k,P)},Je=k=>{var P=Gt();g(k,P)};K(Ue,k=>{t(o)?k(ze):k(Je,!1)})}e(me),e(n),b("click",Me,De),g(a,n)},qe=a=>{var n=At();g(a,n)};K(Le,a=>{L()?a(Re):a(qe,!1)})}g(Se,fe),xt(),Ee()}it(["click","keydown","input","change"]);export{Jt as component};
