import{d as it,c as dt,a as y,s as E,b as d,f as C,e as k}from"../chunks/CyNfHtry.js";import{p as bt,b as ut,d as vt,u as pt,f as Ce,a as xt,e as _t,c as a,s as r,r as e,t as G,g as t,h as Z,n as $e}from"../chunks/DUOIInB9.js";import{i as N,a as Fe,s as ht}from"../chunks/B22MubrG.js";import{e as pe,i as xe}from"../chunks/C2eLq_D0.js";import{r as f,s as w,a as Pe}from"../chunks/C0zNEv0Q.js";import{s as ft}from"../chunks/D7iecON0.js";import{i as mt,s as yt}from"../chunks/Ce36oStv.js";import{d as gt,s as W,p as ee,i as R,r as kt,b as te,e as wt,g as Ct,f as $t,u as Ft}from"../chunks/B-0l54sc.js";import{s as O}from"../chunks/neMrXvPf.js";import{p as _e}from"../chunks/DfOa05yV.js";var Pt=C('<div role="button" tabindex="0"><div><div class="font-medium"> </div> <div class="text-xs text-text-secondary"> </div></div> <button class="text-text-secondary hover:text-error text-xs px-1">x</button></div>'),St=C('<button class="mt-4 w-full px-3 py-2 text-xs bg-surface hover:bg-surface-hover rounded text-center">Generate All Parts</button>'),jt=C("<option> </option>"),Et=C('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Toe Kick</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Height</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Setback</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div></div></div>'),Tt=C('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Drawers</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Count</label> <input type="number" min="1" max="10" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Slide Clearance</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div></div></div>'),Bt=C('<div class="col-span-2 border-t border-border pt-3 mt-2"><h3 class="text-sm font-semibold mb-2">Stretchers</h3> <div class="grid grid-cols-2 gap-3"><div><label class="block text-xs text-text-secondary mb-1">Front Width</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="flex items-center gap-2 text-xs text-text-secondary cursor-pointer mt-5"><input type="checkbox" class="accent-accent"/> Has Rear Stretcher</label></div></div></div>'),Dt=C('<tr class="border-b border-border/50"><td class="py-1"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td><td class="py-1 text-right"> </td></tr>'),Ht=C('<div class="mt-6 border-t border-border pt-4"><h3 class="text-sm font-semibold mb-2"> </h3> <div class="overflow-auto max-h-64"><table class="w-full text-xs"><thead><tr class="text-text-secondary border-b border-border"><th class="py-1 text-left">Label</th><th class="py-1 text-right">Width</th><th class="py-1 text-right">Height</th><th class="py-1 text-right">Qty</th><th class="py-1 text-right">Ops</th></tr></thead><tbody></tbody></table></div></div>'),It=C('<h2 class="text-lg font-semibold mb-4"> </h2> <div class="grid grid-cols-2 gap-4 max-w-lg"><div class="col-span-2"><label class="block text-xs text-text-secondary mb-1">Name</label> <input type="text" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div class="col-span-2"><label class="block text-xs text-text-secondary mb-1">Type</label> <select class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"></select></div> <div><label class="block text-xs text-text-secondary mb-1">Width</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Height</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Depth</label> <input type="number" step="0.25" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Shelves</label> <input type="number" min="0" max="20" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Material Thickness</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="block text-xs text-text-secondary mb-1">Back Thickness</label> <input type="number" step="0.125" class="w-full px-3 py-2 bg-surface border border-border rounded text-sm text-text-primary focus:outline-none focus:border-accent"/></div> <div><label class="flex items-center gap-2 text-xs text-text-secondary cursor-pointer"><input type="checkbox" class="accent-accent"/> Has Back Panel</label></div> <!> <!> <!></div> <!>',1),Gt=C('<div class="flex items-center justify-center h-full text-text-secondary"><p>Select a cabinet from the list or add a new one</p></div>'),Wt=C('<div class="flex gap-6 h-full"><div class="w-56 flex-shrink-0"><div class="flex items-center justify-between mb-3"><h2 class="text-lg font-semibold">Cabinets</h2> <button class="px-2 py-1 text-xs bg-accent hover:bg-accent/80 text-white rounded">+ Add</button></div> <div class="space-y-1"></div> <!></div> <div class="flex-1 overflow-auto"><!></div></div>'),At=C('<div class="text-text-secondary"><p>No project loaded. <a href="/" class="text-accent hover:underline">Go home</a> to create or open one.</p></div>');function Jt(Se,je){bt(je,!0);const T=()=>Fe(O,"$selectedCabinetIndex",he),K=()=>Fe(ee,"$project",he),[he,Ee]=ht();let Q=ut(vt([]));const Te=[{value:"basic_box",label:"Basic Box"},{value:"base_cabinet",label:"Base Cabinet"},{value:"wall_cabinet",label:"Wall Cabinet"},{value:"tall_cabinet",label:"Tall Cabinet"},{value:"sink_base",label:"Sink Base"},{value:"drawer_bank",label:"Drawer Bank"}];function Be(){return{name:"New Cabinet",cabinet_type:"basic_box",width:36,height:30,depth:12,material_thickness:.75,back_thickness:.25,shelf_count:2,shelf_joinery:"dado",dado_depth_fraction:.5,has_back:!0,back_joinery:"rabbet",toe_kick:null,drawers:null,stretchers:null,construction:"frameless",face_frame:null,material_ref:null,back_material_ref:null}}async function De(){_e();try{R.set(!0);const s=Be(),n=await wt(s);ee.update(x=>(x&&x.cabinets.push(s),x)),O.set(n),te.set(!0),W("Cabinet added","success")}catch(s){W(`Error: ${s}`,"error")}finally{R.set(!1)}}async function He(s){_e();try{R.set(!0),await kt(s),ee.update(n=>(n&&n.cabinets.splice(s,1),n)),T()===s&&O.set(null),te.set(!0),W("Cabinet removed","success")}catch(n){W(`Error: ${n}`,"error")}finally{R.set(!1)}}async function v(){_e();const s=T(),n=K();if(!(s===null||!n||s>=n.cabinets.length))try{await Ft(s,n.cabinets[s]),te.set(!0)}catch(x){W(`Error: ${x}`,"error")}}async function Ie(){try{R.set(!0);const s=await Ct();$t.set(s),W(`Generated ${s.length} parts`,"success")}catch(s){W(`Error: ${s}`,"error")}finally{R.set(!1)}}async function Ge(){const s=T(),n=K();if(!(s===null||!n||s>=n.cabinets.length))try{_t(Q,await gt(n.cabinets[s]),!0)}catch(x){W(`Error: ${x}`,"error")}}function p(s,n){const x=T();ee.update(D=>(D&&x!==null&&x<D.cabinets.length&&(D.cabinets[x][s]=n),D)),te.set(!0)}function We(){const s=T(),n=K();return s===null||!n||s>=n.cabinets.length?null:n.cabinets[s]}pt(()=>{T()!==null&&Ge()});const o=Z(We),Ae=Z(()=>t(o)?.cabinet_type==="base_cabinet"||t(o)?.cabinet_type==="tall_cabinet"||t(o)?.cabinet_type==="drawer_bank"),Ne=Z(()=>t(o)?.cabinet_type==="drawer_bank"),Ke=Z(()=>t(o)?.cabinet_type==="sink_base");var fe=dt(),Le=Ce(fe);{var Re=s=>{var n=Wt(),x=a(n),D=a(x),Me=r(a(D),2);e(D);var ae=r(D,2);pe(ae,5,()=>K().cabinets,xe,(g,F,P)=>{var H=Pt();let L;var A=a(H),I=a(A),q=a(I,!0);e(I);var S=r(I,2),U=a(S,!0);e(S),e(A);var M=r(A,2);e(H),G(j=>{L=ft(H,1,"w-full flex items-center justify-between px-3 py-2 text-sm rounded transition-colors text-left cursor-pointer",null,L,{"bg-surface":T()===P,"text-accent":T()===P,"hover:bg-surface-hover":T()!==P}),E(q,t(F).name),E(U,j)},[()=>t(F).cabinet_type.replace("_"," ")]),d("click",H,()=>O.set(P)),d("keydown",H,j=>{j.key==="Enter"&&O.set(P)}),d("click",M,j=>{j.stopPropagation(),He(P)}),y(g,H)}),e(ae);var Oe=r(ae,2);{var Qe=g=>{var F=St();d("click",F,Ie),y(g,F)};N(Oe,g=>{K().cabinets.length>0&&g(Qe)})}e(x);var me=r(x,2),Ue=a(me);{var ze=g=>{var F=It(),P=Ce(F),H=a(P);e(P);var L=r(P,2),A=a(L),I=r(a(A),2);f(I),e(A);var q=r(A,2),S=r(a(q),2);pe(S,21,()=>Te,xe,(l,b)=>{var u=jt(),_=a(u,!0);e(u);var i={};G(()=>{E(_,t(b).label),i!==(i=t(b).value)&&(u.value=(u.__value=t(b).value)??"")}),y(l,u)}),e(S);var U;mt(S),e(q);var M=r(q,2),j=r(a(M),2);f(j),e(M);var re=r(M,2),z=r(a(re),2);f(z),e(re);var se=r(re,2),J=r(a(se),2);f(J),e(se);var le=r(se,2),V=r(a(le),2);f(V),e(le);var oe=r(le,2),X=r(a(oe),2);f(X),e(oe);var ne=r(oe,2),Y=r(a(ne),2);f(Y),e(ne);var ce=r(ne,2),ye=a(ce),ie=a(ye);f(ie),$e(),e(ye),e(ce);var ge=r(ce,2);{var Ve=l=>{var b=Et(),u=r(a(b),2),_=a(u),i=r(a(_),2);f(i),e(_);var $=r(_,2),h=r(a($),2);f(h),e($),e(u),e(b),G(()=>{w(i,t(o).toe_kick?.height??4),w(h,t(o).toe_kick?.setback??3)}),d("input",i,m=>{const c=t(o)?.toe_kick??{height:4,setback:3};c.height=parseFloat(m.target.value),p("toe_kick",c)}),k("blur",i,v),d("input",h,m=>{const c=t(o)?.toe_kick??{height:4,setback:3};c.setback=parseFloat(m.target.value),p("toe_kick",c)}),k("blur",h,v),y(l,b)};N(ge,l=>{t(Ae)&&l(Ve)})}var ke=r(ge,2);{var Xe=l=>{var b=Tt(),u=r(a(b),2),_=a(u),i=r(a(_),2);f(i),e(_);var $=r(_,2),h=r(a($),2);f(h),e($),e(u),e(b),G(()=>{w(i,t(o).drawers?.count??4),w(h,t(o).drawers?.slide_clearance??.5)}),d("input",i,m=>{const c=t(o)?.drawers??{count:4,opening_height:0,slide_clearance:.5};c.count=parseInt(m.target.value),p("drawers",c)}),k("blur",i,v),d("input",h,m=>{const c=t(o)?.drawers??{count:4,opening_height:0,slide_clearance:.5};c.slide_clearance=parseFloat(m.target.value),p("drawers",c)}),k("blur",h,v),y(l,b)};N(ke,l=>{t(Ne)&&l(Xe)})}var Ye=r(ke,2);{var Ze=l=>{var b=Bt(),u=r(a(b),2),_=a(u),i=r(a(_),2);f(i),e(_);var $=r(_,2),h=a($),m=a(h);f(m),$e(),e(h),e($),e(u),e(b),G(()=>{w(i,t(o).stretchers?.front_width??4),Pe(m,t(o).stretchers?.has_rear??!0)}),d("input",i,c=>{const B=t(o)?.stretchers??{front_width:4,has_rear:!0};B.front_width=parseFloat(c.target.value),p("stretchers",B)}),k("blur",i,v),d("change",m,c=>{const B=t(o)?.stretchers??{front_width:4,has_rear:!0};B.has_rear=c.target.checked,p("stretchers",B),v()}),y(l,b)};N(Ye,l=>{t(Ke)&&l(Ze)})}e(L);var et=r(L,2);{var tt=l=>{var b=Ht(),u=a(b),_=a(u);e(u);var i=r(u,2),$=a(i),h=r(a($));pe(h,21,()=>t(Q),xe,(m,c)=>{var B=Dt(),de=a(B),at=a(de,!0);e(de);var be=r(de),rt=a(be);e(be);var ue=r(be),st=a(ue);e(ue);var ve=r(ue),lt=a(ve,!0);e(ve);var we=r(ve),ot=a(we,!0);e(we),e(B),G((nt,ct)=>{E(at,t(c).label),E(rt,`${nt??""}"`),E(st,`${ct??""}"`),E(lt,t(c).quantity),E(ot,t(c).operations.length)},[()=>t(c).rect.width.toFixed(3),()=>t(c).rect.height.toFixed(3)]),y(m,B)}),e(h),e($),e(i),e(b),G(()=>E(_,`Parts Preview (${t(Q).length??""} parts)`)),y(l,b)};N(et,l=>{t(Q).length>0&&l(tt)})}G(()=>{E(H,`Edit: ${t(o).name??""}`),w(I,t(o).name),U!==(U=t(o).cabinet_type)&&(S.value=(S.__value=t(o).cabinet_type)??"",yt(S,t(o).cabinet_type)),w(j,t(o).width),w(z,t(o).height),w(J,t(o).depth),w(V,t(o).shelf_count),w(X,t(o).material_thickness),w(Y,t(o).back_thickness),Pe(ie,t(o).has_back)}),d("input",I,l=>p("name",l.target.value)),k("blur",I,v),d("change",S,l=>{p("cabinet_type",l.target.value),v()}),d("input",j,l=>p("width",parseFloat(l.target.value))),k("blur",j,v),d("input",z,l=>p("height",parseFloat(l.target.value))),k("blur",z,v),d("input",J,l=>p("depth",parseFloat(l.target.value))),k("blur",J,v),d("input",V,l=>p("shelf_count",parseInt(l.target.value))),k("blur",V,v),d("input",X,l=>p("material_thickness",parseFloat(l.target.value))),k("blur",X,v),d("input",Y,l=>p("back_thickness",parseFloat(l.target.value))),k("blur",Y,v),d("change",ie,l=>{p("has_back",l.target.checked),v()}),y(g,F)},Je=g=>{var F=Gt();y(g,F)};N(Ue,g=>{t(o)?g(ze):g(Je,!1)})}e(me),e(n),d("click",Me,De),y(s,n)},qe=s=>{var n=At();y(s,n)};N(Le,s=>{K()?s(Re):s(qe,!1)})}y(Se,fe),xt(),Ee()}it(["click","keydown","input","change"]);export{Jt as component};
