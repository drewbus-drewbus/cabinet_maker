import{d as je,c as Pe,a as l,b as j,f as d,s as f}from"../chunks/pWOMhstZ.js";import{p as Re,b as C,d as Se,f as P,a as Le,s as t,c as s,r as a,g as n,e as R,t as g}from"../chunks/BepynHdk.js";import{i as _,s as Ce,a as ae}from"../chunks/CaLNNbA5.js";import{e as z,i as F}from"../chunks/9pRRSWtK.js";import{r as se}from"../chunks/BfDX1O-d.js";import{b as oe}from"../chunks/BzQBFsv6.js";import{p as Ee,k as ne,i as G,v as Oe,s as k,q as Ue,t as Ve}from"../chunks/DEoDEiov.js";var Ae=d('<div class="text-success text-sm">All checks passed</div>'),Ne=d('<div class="text-xs text-red-300 mb-1"> </div>'),De=d('<div class="text-error text-sm mb-2"> </div> <!>',1),Ie=d('<div class="text-xs text-yellow-300 mb-1"> </div>'),Je=d('<div class="text-warning text-sm mt-2 mb-2"> </div> <!>',1),Me=d("<!> <!> <!>",1),qe=d('<li class="flex items-center gap-2"><span class="font-mono"> </span> <button class="text-accent hover:underline">Download</button></li>'),Be=d('<div class="text-sm text-success mb-2"> </div> <ul class="text-xs text-text-secondary space-y-1"></ul> <button class="mt-2 px-3 py-1 text-xs bg-surface hover:bg-surface-hover rounded">Download All</button>',1),Te=d('<pre class="bg-bg-secondary rounded p-4 overflow-auto max-h-96 text-xs font-mono text-green-300 leading-relaxed"> </pre>'),ze=d('<p class="text-text-secondary text-sm">Click "Preview" to see generated G-code.</p>'),Fe=d('<div><h1 class="text-2xl font-bold mb-6">Generate G-code</h1> <div class="grid grid-cols-2 gap-6 mb-6"><div class="p-4 bg-surface rounded-lg border border-border"><h2 class="text-lg font-semibold mb-3">Validation</h2> <button class="px-4 py-2 text-sm bg-surface-hover hover:bg-accent/50 rounded mb-3">Validate Project</button> <!></div> <div class="p-4 bg-surface rounded-lg border border-border"><h2 class="text-lg font-semibold mb-3">Generate</h2> <button class="px-4 py-2 text-sm bg-accent hover:bg-accent/80 text-white rounded mb-3">Generate G-code</button> <!></div></div> <div class="p-4 bg-surface rounded-lg border border-border"><div class="flex items-center justify-between mb-3"><h2 class="text-lg font-semibold">G-code Preview</h2> <div class="flex items-center gap-2"><label class="text-xs text-text-secondary">Material: <input type="number" min="0" class="w-12 px-1 py-0.5 bg-bg border border-border rounded text-xs text-text-primary ml-1"/></label> <label class="text-xs text-text-secondary">Sheet: <input type="number" min="0" class="w-12 px-1 py-0.5 bg-bg border border-border rounded text-xs text-text-primary ml-1"/></label> <button class="px-3 py-1 text-xs bg-surface-hover hover:bg-accent/50 rounded">Preview</button></div></div> <!></div></div>'),He=d('<div class="text-text-secondary"><p>No project loaded. <a href="/" class="text-accent hover:underline">Go home</a> to create or open one.</p></div>');function tt(le,de){Re(de,!0);const ie=()=>ae(Ee,"$project",H),v=()=>ae(ne,"$validationResult",H),[H,ce]=Ce();let S=C(""),h=C(Se([])),E=C(0),O=C(0);async function ve(){try{G.set(!0);const e=await Oe();ne.set(e),e.errors.length===0?k("Validation passed","success"):k(`${e.errors.length} error(s) found`,"error")}catch(e){k(`Error: ${e}`,"error")}finally{G.set(!1)}}async function be(){try{G.set(!0),R(h,await Ue(),!0),k(`Generated ${n(h).length} G-code file(s)`,"success")}catch(e){k(`Error: ${e}`,"error")}finally{G.set(!1)}}function K(e){const p=new Blob([e.gcode],{type:"text/plain"}),y=URL.createObjectURL(p),b=document.createElement("a");b.href=y,b.download=e.filename,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(y)}function xe(){for(const e of n(h))K(e)}async function ue(){try{G.set(!0),R(S,await Ve(n(E),n(O)),!0)}catch(e){k(`Error: ${e}`,"error"),R(S,"")}finally{G.set(!1)}}var Q=Pe(),pe=P(Q);{var me=e=>{var p=Fe(),y=t(s(p),2),b=s(y),W=t(s(b),2),ge=t(W,2);{var _e=r=>{var i=Me(),u=P(i);{var N=o=>{var c=Ae();l(o,c)};_(u,o=>{v().errors.length===0&&v().warnings.length===0&&o(N)})}var w=t(u,2);{var D=o=>{var c=De(),x=P(c),$=s(x);a(x);var J=t(x,2);z(J,1,()=>v().errors,F,(M,q)=>{var m=Ne(),B=s(m,!0);a(m),g(T=>f(B,T),[()=>JSON.stringify(n(q))]),l(M,m)}),g(()=>f($,`${v().errors.length??""} error(s)`)),l(o,c)};_(w,o=>{v().errors.length>0&&o(D)})}var I=t(w,2);{var L=o=>{var c=Je(),x=P(c),$=s(x);a(x);var J=t(x,2);z(J,1,()=>v().warnings,F,(M,q)=>{var m=Ie(),B=s(m,!0);a(m),g(T=>f(B,T),[()=>JSON.stringify(n(q))]),l(M,m)}),g(()=>f($,`${v().warnings.length??""} warning(s)`)),l(o,c)};_(I,o=>{v().warnings.length>0&&o(L)})}l(r,i)};_(ge,r=>{v()&&r(_e)})}a(b);var X=t(b,2),Y=t(s(X),2),he=t(Y,2);{var ye=r=>{var i=Be(),u=P(i),N=s(u);a(u);var w=t(u,2);z(w,21,()=>n(h),F,(I,L)=>{var o=qe(),c=s(o),x=s(c,!0);a(c);var $=t(c,2);a(o),g(()=>f(x,n(L).filename)),j("click",$,()=>K(n(L))),l(I,o)}),a(w);var D=t(w,2);g(()=>f(N,`Generated ${n(h).length??""} file(s):`)),j("click",D,xe),l(r,i)};_(he,r=>{n(h).length>0&&r(ye)})}a(X),a(y);var Z=t(y,2),U=s(Z),ee=t(s(U),2),V=s(ee),te=t(s(V));se(te),a(V);var A=t(V,2),re=t(s(A));se(re),a(A);var we=t(A,2);a(ee),a(U);var Ge=t(U,2);{var ke=r=>{var i=Te(),u=s(i,!0);a(i),g(()=>f(u,n(S))),l(r,i)},$e=r=>{var i=ze();l(r,i)};_(Ge,r=>{n(S)?r(ke):r($e,!1)})}a(Z),a(p),j("click",W,ve),j("click",Y,be),oe(te,()=>n(E),r=>R(E,r)),oe(re,()=>n(O),r=>R(O,r)),j("click",we,ue),l(e,p)},fe=e=>{var p=He();l(e,p)};_(pe,e=>{ie()?e(me):e(fe,!1)})}l(le,Q),Le(),ce()}je(["click"]);export{tt as component};
